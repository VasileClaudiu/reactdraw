(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{259:function(e,t,n){e.exports=n(548)},501:function(e,t,n){},502:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},503:function(e,t,n){},532:function(e,t){},548:function(e,t,n){"use strict";n.r(t);n(260),n(188),n(309);var a,o=n(0),i=n.n(o),l=n(17),r=n.n(l),s=(n(501),n(502),n(503),n(123)),c=n(60),u=n(131),m=n(124),p=n(130),h=n(88),v=n(34),d=n(43),f=n(50),g="pencil",b="Test WRITE TEXT",y=(a={},Object(d.a)(a,g,function(e){var t=null,n=[],a=function(t,n,a){var o=a.x,i=a.y;e.save(),e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.globalCompositeOperation="source-over",e.moveTo(n.x,n.y),e.lineTo(o,i),e.closePath(),e.stroke(),e.restore()},o=function(e,o){if(!t)return[];var i={x:e,y:o},l=t.points.slice(-1)[0];return a(t,l,i),t.points.push(i),n.push(i),[t]};return{onMouseDown:function(e,n,a,o){return[t={id:Object(f.v4)(),tool:g,color:a,size:o,points:[{x:e,y:n}]}]},onMouseMove:o,onDebouncedMouseMove:function(){var e=n;return n=[],[t,e]},onMouseUp:function(e,a){if(t){o(e,a),n=[];var i=t;return t=null,[i]}},draw:function(e,t){for(var n=0,o=0,i=e.points.length;o<i;o++)e.points[o-1]&&(t?(setTimeout(a.bind(null,e,e.points[o-1],e.points[o]),n),n+=10):a(e,e.points[o-1],e.points[o]))}}}),Object(d.a)(a,"line",function(e){var t=null,n=null,a=function(t,n,a){e.save(),e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.globalCompositeOperation="source-over",e.moveTo(t.start.x,t.start.y),e.lineTo(n,a),e.closePath(),e.stroke(),e.restore()},o=function(o,i){t&&(e.putImageData(n,0,0),a(t,o,i))};return{onMouseDown:function(a,o,i,l){return t={id:Object(f.v4)(),tool:"line",color:i,size:l,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var i=t;return n=null,t=null,i.end={x:e,y:a},[i]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(d.a)(a,"rectangle",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,i=a<t.start.y?a:t.start.y,l=Math.abs(t.start.x-n),r=Math.abs(t.start.y-a);e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.fill,e.rect(o,i,l,r),e.stroke(),t.fill&&e.fill()},o=function(o,i){t&&(e.putImageData(n,0,0),e.save(),a(t,o,i),e.restore())};return{onMouseDown:function(a,o,i,l,r){return t={id:Object(f.v4)(),tool:"rectangle",color:i,size:l,fill:r,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var i=t;return n=null,t=null,i.end={x:e,y:a},[i]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(d.a)(a,"ellipse",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,i=a<t.start.y?a:t.start.y,l=.5*((n>=t.start.x?n:t.start.x)-o),r=.5*((a>=t.start.y?a:t.start.y)-i),s=o+l,c=i+r;e.save(),e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.fill,"function"===typeof e.ellipse?e.ellipse(s,c,l,r,0,0,2*Math.PI):function(t,n,a,o){for(var i,l,r=0;r<2*Math.PI;r+=.01)i=t-o*Math.sin(r)*Math.sin(0)+a*Math.cos(r)*Math.cos(0),l=n+a*Math.cos(r)*Math.sin(0)+o*Math.sin(r)*Math.cos(0),0===r?e.moveTo(i,l):e.lineTo(i,l)}(s,c,l,r),e.stroke(),t.fill&&e.fill(),e.closePath(),e.restore()},o=function(o,i){t&&(e.putImageData(n,0,0),a(t,o,i))};return{onMouseDown:function(a,o,i,l,r){return t={id:Object(f.v4)(),tool:"ellipse",color:i,size:l,fill:r,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var i=t;return n=null,t=null,i.end={x:e,y:a},[i]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(d.a)(a,"text",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,i=a<t.start.y?a:t.start.y;e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.fill,e.stroke(),t.fillText&&e.fillText(t.fillText,o,i)},o=function(o,i){t&&(e.putImageData(n,0,0),e.save(),a(t,o,i),e.restore())};return{onMouseDown:function(a,o,i,l,r,s){return t={id:Object(f.v4)(),tool:"text",color:i,size:l,fill:r,fillText:s||b,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var i=t;return n=null,t=null,i.end={x:e,y:a},[i]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),a),E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).tool=null,n.interval=null,n.initTool=n.initTool.bind(Object(v.a)(n)),n.onMouseDown=n.onMouseDown.bind(Object(v.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(v.a)(n)),n.onDebouncedMove=n.onDebouncedMove.bind(Object(v.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(v.a)(n)),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.canvas=Object(l.findDOMNode)(this.canvasRef),this.ctx=this.canvas.getContext("2d"),this.initTool(this.props.tool)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.tool;e.items.filter(function(e){return-1===t.props.items.indexOf(e)}).forEach(function(e){t.initTool(e.tool),t.tool.draw(e,t.props.animate)}),this.initTool(n)}},{key:"initTool",value:function(e){this.tool=this.props.toolsMap[e](this.ctx)}},{key:"onMouseDown",value:function(e){var t,n=(t=this.tool).onMouseDown.apply(t,Object(h.a)(this.getCursorPosition(e)).concat([this.props.color,this.props.size,this.props.fillColor,this.props.fillText]));n&&n[0]&&this.props.onItemStart&&this.props.onItemStart.apply(null,n),this.props.onDebouncedItemChange&&(this.interval=setInterval(this.onDebouncedMove,this.props.debounceTime))}},{key:"onDebouncedMove",value:function(){"function"==typeof this.tool.onDebouncedMouseMove&&this.props.onDebouncedItemChange&&this.props.onDebouncedItemChange.apply(null,this.tool.onDebouncedMouseMove())}},{key:"onMouseMove",value:function(e){var t,n=(t=this.tool).onMouseMove.apply(t,Object(h.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onEveryItemChange&&this.props.onEveryItemChange.apply(null,n)}},{key:"onMouseUp",value:function(e){var t,n=(t=this.tool).onMouseUp.apply(t,Object(h.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onCompleteItem&&this.props.onCompleteItem.apply(null,n),this.props.onDebouncedItemChange&&(clearInterval(this.interval),this.interval=null)}},{key:"getCursorPosition",value:function(e){var t=this.canvas.getBoundingClientRect(),n=t.top,a=t.left;return[e.clientX-a,e.clientY-n]}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,o=t.canvasClassName;return i.a.createElement("canvas",{ref:function(t){e.canvasRef=t},id:o,className:o,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseOut:this.onMouseUp,onMouseUp:this.onMouseUp,width:n,height:a})}}]),t}(o.Component);E.defaultProps={width:500,height:500,color:"#000",size:5,fillColor:"",fillText:"",canvasClassName:"canvas",debounceTime:1e3,animate:!0,tool:g,toolsMap:y};var M=n(250),x=n.n(M),C=n(580),k=x()("ws://127.0.0.1:12346"),w=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).socket=null,n.myInput=i.a.createRef(),n.state={tool:g,size:2,color:"#000000",fill:!1,fillColor:"#444444",filltext:b,items:[]},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;k.on("addItem",function(t){return e.setState({items:e.state.items.concat([t])})})}},{key:"fixType",value:function(e){return"image/"+(e=e.toString().toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}},{key:"getImageData",value:function(e){var t=e.width,n=e.height;return e.getContext("2d").getImageData(0,0,t,n)}},{key:"genBitmapImage",value:function(e){var t=e.width,n=e.height,a=t*n*3,o=a+54,i=[66,77,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,54,0,0,0],l=[40,0,0,0,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=(4-3*t%4)%4,s=e.data,c="",u=t<<2,m=n,p=String.fromCharCode;do{for(var h=u*(m-1),v="",d=0;d<t;d++){var f=d<<2;v+=p(s[h+f+2])+p(s[h+f+1])+p(s[h+f])}for(var g=0;g<r;g++)v+=String.fromCharCode(0);c+=v}while(--m);return this.encodeData(i.concat(l))+this.encodeData(c)}},{key:"encodeData",value:function(e){if(!window.btoa)throw"btoa undefined";var t="";if("string"==typeof e)t=e;else for(var n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}},{key:"saveFile",value:function(e){document.write('<img src="'+e+'"/>')}},{key:"scaleCanvas",value:function(e,t,n){var a=e.width,o=e.height;void 0===t&&(t=a),void 0===n&&(n=o);var i=document.createElement("canvas"),l=i.getContext("2d");return i.width=t,i.height=n,l.drawImage(e,0,0,a,o,0,0,t,n),i}},{key:"makeURI",value:function(e,t){return"data:"+t+";base64,"+e}},{key:"getDataURL",value:function(e,t,n,a){return(e=this.scaleCanvas(e,n,a)).toDataURL(t)}},{key:"saveAsImage",value:function(e,t,n,a){if(e&&e.toDataURL())if("string"==typeof e&&(e=document.getElementById(e)),void 0===a&&(a="png"),a=this.fixType(a),/bmp/.test(a)){var o=this.getImageData(this.scaleCanvas(e,t,n)),i=this.genBitmapImage(o);this.saveFile(this.makeURI(i,"image/octet-stream"))}else{var l=this.getDataURL(e,a,t,n);this.saveFile(l.replace(a,"image/octet-stream"))}}},{key:"savecanvas",value:function(){var e=document.getElementById("canvas"),t=document.getElementById("sel").value;this.saveAsImage(e,this.myInput.current.offsetWidth,this.myInput.current.offsetHeight,t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.tool,a=t.size,o=t.color,l=t.fill,r=t.fillColor,s=t.filltext,c=t.items;return i.a.createElement("div",{style:{marginTop:-50,marginBottom:0}},i.a.createElement("h2",null,"React Draw Pad"),i.a.createElement(C.a,{container:!0,spacing:12},i.a.createElement(C.a,{item:!0,xs:12},i.a.createElement("div",{ref:this.myInput,className:"divcansas",style:{float:"left",marginTop:-20}},i.a.createElement(E,{width:500,height:500,animate:!0,size:a,color:o,fillColor:l?r:"",fillText:s,items:c,tool:n,onCompleteItem:function(e){return k.emit("addItem",e)}})),i.a.createElement("div",{style:{float:"left",position:"relative"}},i.a.createElement("div",{className:"tools",style:{marginBottom:20}},i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{onClick:function(){return e.savecanvas()}},"Save"),i.a.createElement("select",{id:"sel"},i.a.createElement("option",{value:"png"},"png"),i.a.createElement("option",{value:"jpeg"},"jpeg"),i.a.createElement("option",{value:"bmp"},"bmp"))),i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{style:n===g?{fontWeight:"bold"}:void 0,className:n===g?"item-active":"item",onClick:function(){return e.setState({tool:g})}},"Pencil")),i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{style:"line"===n?{fontWeight:"bold"}:void 0,className:"line"===n?"item-active":"item",onClick:function(){return e.setState({tool:"line"})}},"Line")),i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{style:"ellipse"===n?{fontWeight:"bold"}:void 0,className:"ellipse"===n?"item-active":"item",onClick:function(){return e.setState({tool:"ellipse"})}},"Ellipse")),i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{style:"rectangle"===n?{fontWeight:"bold"}:void 0,className:"rectangle"===n?"item-active":"item",onClick:function(){return e.setState({tool:"rectangle"})}},"Rectangle")),i.a.createElement(C.a,{item:!0,xs:3},i.a.createElement("button",{style:"text"===n?{fontWeight:"bold"}:void 0,className:"text"===n?"item-active":"item",onClick:function(){return e.setState({tool:"text"})}},"Text"))),i.a.createElement("div",{className:"options",style:{marginBottom:20}},i.a.createElement("label",{htmlFor:""},"size: "),i.a.createElement("input",{min:"1",max:"20",type:"range",value:a,onChange:function(t){return e.setState({size:parseInt(t.target.value)})}})),i.a.createElement("div",{className:"options",style:{marginBottom:20}},i.a.createElement("label",{htmlFor:""},"color: "),i.a.createElement("input",{type:"color",value:o,onChange:function(t){return e.setState({color:t.target.value})}})),"ellipse"===this.state.tool||"rectangle"===this.state.tool?i.a.createElement("div",null,i.a.createElement("label",{htmlFor:""},"fill in:"),i.a.createElement("input",{type:"checkbox",value:l,style:{margin:"0 8"},onChange:function(t){return e.setState({fill:t.target.checked})}}),l?i.a.createElement("span",null,i.a.createElement("label",{htmlFor:""},"with color:"),i.a.createElement("input",{type:"color",value:r,onChange:function(t){return e.setState({fillColor:t.target.value})}})):""):"","text"===this.state.tool?i.a.createElement("div",null,i.a.createElement("label",{htmlFor:""},"Text:"),i.a.createElement("input",{type:"text",value:s,style:{margin:"0 8"},onChange:function(t){return e.setState({filltext:t.target.value})}})):""))))}}]),t}(o.Component),I=n(166),O=n(581),D=n(585),j=n(586),T=n(583),S=n(587),N=n(589),z=n(584),P=n(590),R=n(588),W=n(162),U=n(254),B=n.n(U),F=n(255),L=n.n(F),H=n(165),A=n.n(H),J=n(163),X=n.n(J),G=n(164),Y=n.n(G),$=n(256),q=n.n($),K=Object(O.a)(function(e){return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(d.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(d.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(W.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(W.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(d.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),sectionDesktop:Object(d.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(d.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}});var Q=function(){var e=K(),t=i.a.useState(null),n=Object(I.a)(t,2),a=n[0],o=n[1],l=i.a.useState(null),r=Object(I.a)(l,2),s=r[0],c=r[1],u=Boolean(a),m=Boolean(s);function p(e){o(e.currentTarget)}function h(){c(null)}function v(){o(null),h()}var d=i.a.createElement(R.a,{anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:v},i.a.createElement(P.a,{onClick:v},"Profile"),i.a.createElement(P.a,{onClick:v},"My account")),f=i.a.createElement(R.a,{anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:m,onClose:h},i.a.createElement(P.a,null,i.a.createElement(T.a,{color:"inherit"},i.a.createElement(z.a,{badgeContent:4,color:"secondary"},i.a.createElement(X.a,null))),i.a.createElement("p",null,"Messages")),i.a.createElement(P.a,null,i.a.createElement(T.a,{color:"inherit"},i.a.createElement(z.a,{badgeContent:11,color:"secondary"},i.a.createElement(Y.a,null))),i.a.createElement("p",null,"Notifications")),i.a.createElement(P.a,{onClick:p},i.a.createElement(T.a,{color:"inherit"},i.a.createElement(A.a,null)),i.a.createElement("p",null,"Profile")));return i.a.createElement("div",{className:e.grow},i.a.createElement(D.a,{position:"static"},i.a.createElement(j.a,null,i.a.createElement(T.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"Open drawer"},i.a.createElement(B.a,null)),i.a.createElement(S.a,{className:e.title,variant:"h6",noWrap:!0},"Material-UI"),i.a.createElement("div",{className:e.search},i.a.createElement("div",{className:e.searchIcon},i.a.createElement(L.a,null)),i.a.createElement(N.a,{placeholder:"Search\u2026",classes:{root:e.inputRoot,input:e.inputInput}})),i.a.createElement("div",{className:e.grow}),i.a.createElement("div",{className:e.sectionDesktop},i.a.createElement(T.a,{color:"inherit"},i.a.createElement(z.a,{badgeContent:4,color:"secondary"},i.a.createElement(X.a,null))),i.a.createElement(T.a,{color:"inherit"},i.a.createElement(z.a,{badgeContent:17,color:"secondary"},i.a.createElement(Y.a,null))),i.a.createElement(T.a,{edge:"end","aria-owns":u?"material-appbar":void 0,"aria-haspopup":"true",onClick:p,color:"inherit"},i.a.createElement(A.a,null))),i.a.createElement("div",{className:e.sectionMobile},i.a.createElement(T.a,{"aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit"},i.a.createElement(q.a,null))))),d,f)};var V=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(Q,null),i.a.createElement("header",{className:"App-header"},i.a.createElement(w,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[259,1,2]]]);
//# sourceMappingURL=main.baa7b7a5.chunk.js.map