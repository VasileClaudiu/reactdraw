(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{259:function(e,t,n){e.exports=n(548)},501:function(e,t,n){},502:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},503:function(e,t,n){},532:function(e,t){},548:function(e,t,n){"use strict";n.r(t);n(260),n(188),n(309);var a,o=n(0),l=n.n(o),i=n(17),r=n.n(i),s=(n(501),n(502),n(503),n(123)),c=n(60),u=n(131),m=n(124),p=n(130),h=n(88),v=n(34),f=n(43),d=n(50),g="pencil",y="Test WRITE TEXT",b=(a={},Object(f.a)(a,g,function(e){var t=null,n=[],a=function(t,n,a){var o=a.x,l=a.y;e.save(),e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.globalCompositeOperation="source-over",e.moveTo(n.x,n.y),e.lineTo(o,l),e.closePath(),e.stroke(),e.restore()},o=function(e,o){if(!t)return[];var l={x:e,y:o},i=t.points.slice(-1)[0];return a(t,i,l),t.points.push(l),n.push(l),[t]};return{onMouseDown:function(e,n,a,o){return[t={id:Object(d.v4)(),tool:g,color:a,size:o,points:[{x:e,y:n}]}]},onMouseMove:o,onDebouncedMouseMove:function(){var e=n;return n=[],[t,e]},onMouseUp:function(e,a){if(t){o(e,a),n=[];var l=t;return t=null,[l]}},draw:function(e,t){for(var n=0,o=0,l=e.points.length;o<l;o++)e.points[o-1]&&(t?(setTimeout(a.bind(null,e,e.points[o-1],e.points[o]),n),n+=10):a(e,e.points[o-1],e.points[o]))}}}),Object(f.a)(a,"line",function(e){var t=null,n=null,a=function(t,n,a){e.save(),e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.globalCompositeOperation="source-over",e.moveTo(t.start.x,t.start.y),e.lineTo(n,a),e.closePath(),e.stroke(),e.restore()},o=function(o,l){t&&(e.putImageData(n,0,0),a(t,o,l))};return{onMouseDown:function(a,o,l,i){return t={id:Object(d.v4)(),tool:"line",color:l,size:i,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var l=t;return n=null,t=null,l.end={x:e,y:a},[l]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(f.a)(a,"rectangle",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,l=a<t.start.y?a:t.start.y,i=Math.abs(t.start.x-n),r=Math.abs(t.start.y-a);e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.fill,e.rect(o,l,i,r),e.stroke(),t.fill&&e.fill()},o=function(o,l){t&&(e.putImageData(n,0,0),e.save(),a(t,o,l),e.restore())};return{onMouseDown:function(a,o,l,i,r){return t={id:Object(d.v4)(),tool:"rectangle",color:l,size:i,fill:r,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var l=t;return n=null,t=null,l.end={x:e,y:a},[l]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(f.a)(a,"ellipse",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,l=a<t.start.y?a:t.start.y,i=.5*((n>=t.start.x?n:t.start.x)-o),r=.5*((a>=t.start.y?a:t.start.y)-l),s=o+i,c=l+r;e.save(),e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.fill,"function"===typeof e.ellipse?e.ellipse(s,c,i,r,0,0,2*Math.PI):function(t,n,a,o){for(var l,i,r=0;r<2*Math.PI;r+=.01)l=t-o*Math.sin(r)*Math.sin(0)+a*Math.cos(r)*Math.cos(0),i=n+a*Math.cos(r)*Math.sin(0)+o*Math.sin(r)*Math.cos(0),0===r?e.moveTo(l,i):e.lineTo(l,i)}(s,c,i,r),e.stroke(),t.fill&&e.fill(),e.closePath(),e.restore()},o=function(o,l){t&&(e.putImageData(n,0,0),a(t,o,l))};return{onMouseDown:function(a,o,l,i,r){return t={id:Object(d.v4)(),tool:"ellipse",color:l,size:i,fill:r,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var l=t;return n=null,t=null,l.end={x:e,y:a},[l]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),Object(f.a)(a,"text",function(e){var t=null,n=null,a=function(t,n,a){var o=n<t.start.x?n:t.start.x,l=a<t.start.y?a:t.start.y;t.size&&(e.font=10*t.size+"px Georgia");var i=parseInt(e.measureText(t.fillText).width),r=12*t.size;e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,t.fill&&e.rect(o,l,i,r),e.fillStyle=t.fill,e.stroke(),t.fill&&e.fill(),t.size&&(e.font=10*t.size+"px Georgia"),e.fillStyle=t.color,t.fillText&&e.fillText(t.fillText,o,l+10*t.size)},o=function(o,l){t&&(e.putImageData(n,0,0),e.save(),a(t,o,l),e.restore())};return{onMouseDown:function(a,o,l,i,r,s){return t={id:Object(d.v4)(),tool:"text",color:l,size:i,fill:r,fillText:s||y,start:{x:a,y:o},end:null},n=e.getImageData(0,0,e.canvas.clientWidth,e.canvas.clientHeight),[t]},onMouseMove:o,onMouseUp:function(e,a){if(t){o(e,a);var l=t;return n=null,t=null,l.end={x:e,y:a},[l]}},draw:function(e){return a(e,e.end.x,e.end.y)}}}),a),E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).tool=null,n.interval=null,n.initTool=n.initTool.bind(Object(v.a)(n)),n.onMouseDown=n.onMouseDown.bind(Object(v.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(v.a)(n)),n.onDebouncedMove=n.onDebouncedMove.bind(Object(v.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(v.a)(n)),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.canvas=Object(i.findDOMNode)(this.canvasRef),this.ctx=this.canvas.getContext("2d"),this.initTool(this.props.tool)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.tool;e.items.filter(function(e){return-1===t.props.items.indexOf(e)}).forEach(function(e){t.initTool(e.tool),t.tool.draw(e,t.props.animate)}),this.initTool(n)}},{key:"initTool",value:function(e){this.tool=this.props.toolsMap[e](this.ctx)}},{key:"onMouseDown",value:function(e){var t,n=(t=this.tool).onMouseDown.apply(t,Object(h.a)(this.getCursorPosition(e)).concat([this.props.color,this.props.size,this.props.fillColor,this.props.fillText]));n&&n[0]&&this.props.onItemStart&&this.props.onItemStart.apply(null,n),this.props.onDebouncedItemChange&&(this.interval=setInterval(this.onDebouncedMove,this.props.debounceTime))}},{key:"onDebouncedMove",value:function(){"function"==typeof this.tool.onDebouncedMouseMove&&this.props.onDebouncedItemChange&&this.props.onDebouncedItemChange.apply(null,this.tool.onDebouncedMouseMove())}},{key:"onMouseMove",value:function(e){var t,n=(t=this.tool).onMouseMove.apply(t,Object(h.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onEveryItemChange&&this.props.onEveryItemChange.apply(null,n)}},{key:"onMouseUp",value:function(e){var t,n=(t=this.tool).onMouseUp.apply(t,Object(h.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onCompleteItem&&this.props.onCompleteItem.apply(null,n),this.props.onDebouncedItemChange&&(clearInterval(this.interval),this.interval=null)}},{key:"getCursorPosition",value:function(e){var t=this.canvas.getBoundingClientRect(),n=t.top,a=t.left;return[e.clientX-a,e.clientY-n]}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,o=t.canvasClassName;return l.a.createElement("canvas",{ref:function(t){e.canvasRef=t},id:o,className:o,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseOut:this.onMouseUp,onMouseUp:this.onMouseUp,width:n,height:a})}}]),t}(o.Component);E.defaultProps={width:500,height:500,color:"#000",size:5,fillColor:"",fillText:"",canvasClassName:"canvas",debounceTime:1e3,animate:!0,tool:g,toolsMap:b};var M=n(250),x=n.n(M),w=n(580),C=x()("ws://127.0.0.1:12346"),k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).socket=null,n.myInput=l.a.createRef(),n.state={tool:g,size:2,color:"#000000",fill:!1,fillColor:"#444444",filltext:y,items:[]},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;C.on("addItem",function(t){return e.setState({items:e.state.items.concat([t])})})}},{key:"fixType",value:function(e){return"image/"+(e=e.toString().toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}},{key:"getImageData",value:function(e){var t=e.width,n=e.height;return e.getContext("2d").getImageData(0,0,t,n)}},{key:"genBitmapImage",value:function(e){var t=e.width,n=e.height,a=t*n*3,o=a+54,l=[66,77,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,54,0,0,0],i=[40,0,0,0,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=(4-3*t%4)%4,s=e.data,c="",u=t<<2,m=n,p=String.fromCharCode;do{for(var h=u*(m-1),v="",f=0;f<t;f++){var d=f<<2;v+=p(s[h+d+2])+p(s[h+d+1])+p(s[h+d])}for(var g=0;g<r;g++)v+=String.fromCharCode(0);c+=v}while(--m);return this.encodeData(l.concat(i))+this.encodeData(c)}},{key:"encodeData",value:function(e){if(!window.btoa)throw"btoa undefined";var t="";if("string"==typeof e)t=e;else for(var n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}},{key:"saveFile",value:function(e){document.write('<img src="'+e+'"/>')}},{key:"scaleCanvas",value:function(e,t,n){var a=e.width,o=e.height;void 0===t&&(t=a),void 0===n&&(n=o);var l=document.createElement("canvas"),i=l.getContext("2d");return l.width=t,l.height=n,i.drawImage(e,0,0,a,o,0,0,t,n),l}},{key:"makeURI",value:function(e,t){return"data:"+t+";base64,"+e}},{key:"getDataURL",value:function(e,t,n,a){return(e=this.scaleCanvas(e,n,a)).toDataURL(t)}},{key:"saveAsImage",value:function(e,t,n,a){if(e&&e.toDataURL())if("string"==typeof e&&(e=document.getElementById(e)),void 0===a&&(a="png"),a=this.fixType(a),/bmp/.test(a)){var o=this.getImageData(this.scaleCanvas(e,t,n)),l=this.genBitmapImage(o);this.saveFile(this.makeURI(l,"image/octet-stream"))}else{var i=this.getDataURL(e,a,t,n);this.saveFile(i.replace(a,"image/octet-stream"))}}},{key:"savecanvas",value:function(){var e=document.getElementById("canvas"),t=document.getElementById("sel").value;this.saveAsImage(e,this.myInput.current.offsetWidth,this.myInput.current.offsetHeight,t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.tool,a=t.size,o=t.color,i=t.fill,r=t.fillColor,s=t.filltext,c=t.items;return l.a.createElement("div",{style:{marginTop:-50,marginBottom:0}},l.a.createElement("h2",null,"React Draw Pad"),l.a.createElement(w.a,{container:!0,spacing:2},l.a.createElement(w.a,{item:!0,xs:12},l.a.createElement("div",{ref:this.myInput,className:"divcansas",style:{float:"left",marginTop:-20}},l.a.createElement(E,{width:500,height:500,animate:!0,size:a,color:o,fillColor:i?r:"",fillText:s,items:c,tool:n,onCompleteItem:function(e){return C.emit("addItem",e)}})),l.a.createElement("div",{style:{float:"left",position:"relative"}},l.a.createElement("div",{className:"tools",style:{marginBottom:20}},l.a.createElement(w.a,{item:!0,xs:3},l.a.createElement("button",{onClick:function(){return e.savecanvas()}},"Save"),l.a.createElement("select",{id:"sel"},l.a.createElement("option",{value:"png"},"png"),l.a.createElement("option",{value:"jpeg"},"jpeg"),l.a.createElement("option",{value:"bmp"},"bmp"))),l.a.createElement(w.a,{item:!0,xs:3},l.a.createElement("select",{id:"seltool",onChange:function(t){return e.setState({tool:t.target.value})}},l.a.createElement("option",{value:g},"Pencil"),l.a.createElement("option",{value:"line"},"Line"),l.a.createElement("option",{value:"ellipse"},"Ellipse"),l.a.createElement("option",{value:"rectangle"},"Rectangle"),l.a.createElement("option",{value:"text"},"Text")))),l.a.createElement("div",{className:"options",style:{marginBottom:20}},l.a.createElement("label",{htmlFor:""},"size: "),l.a.createElement("input",{min:"1",max:"20",type:"range",value:a,onChange:function(t){return e.setState({size:parseInt(t.target.value)})}})),l.a.createElement("div",{className:"options",style:{marginBottom:20}},l.a.createElement("label",{htmlFor:""},"color: "),l.a.createElement("input",{type:"color",value:o,onChange:function(t){return e.setState({color:t.target.value})}})),"ellipse"===this.state.tool||"rectangle"===this.state.tool||"text"===this.state.tool?l.a.createElement("div",null,l.a.createElement("label",{htmlFor:""},"fill in:"),l.a.createElement("input",{type:"checkbox",value:i,style:{margin:"0 8"},onChange:function(t){return e.setState({fill:t.target.checked})}}),i?l.a.createElement("span",null,l.a.createElement("label",{htmlFor:""},"with color:"),l.a.createElement("input",{type:"color",value:r,onChange:function(t){return e.setState({fillColor:t.target.value})}})):""):"","text"===this.state.tool?l.a.createElement("div",null,l.a.createElement("label",{htmlFor:""},"Text:"),l.a.createElement("input",{type:"text",value:s,style:{margin:"0 8"},onChange:function(t){return e.setState({filltext:t.target.value})}})):""))))}}]),t}(o.Component),I=n(166),O=n(581),D=n(585),j=n(586),T=n(583),z=n(587),S=n(589),P=n(584),R=n(590),N=n(588),U=n(162),B=n(254),W=n.n(B),F=n(255),L=n.n(F),H=n(165),A=n.n(H),J=n(163),G=n.n(J),X=n(164),Y=n.n(X),$=n(256),q=n.n($),K=Object(O.a)(function(e){return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(f.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(f.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(U.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(U.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(f.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),sectionDesktop:Object(f.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(f.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}});var Q=function(){var e=K(),t=l.a.useState(null),n=Object(I.a)(t,2),a=n[0],o=n[1],i=l.a.useState(null),r=Object(I.a)(i,2),s=r[0],c=r[1],u=Boolean(a),m=Boolean(s);function p(e){o(e.currentTarget)}function h(){c(null)}function v(){o(null),h()}var f=l.a.createElement(N.a,{anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:v},l.a.createElement(R.a,{onClick:v},"Profile"),l.a.createElement(R.a,{onClick:v},"My account")),d=l.a.createElement(N.a,{anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:m,onClose:h},l.a.createElement(R.a,null,l.a.createElement(T.a,{color:"inherit"},l.a.createElement(P.a,{badgeContent:4,color:"secondary"},l.a.createElement(G.a,null))),l.a.createElement("p",null,"Messages")),l.a.createElement(R.a,null,l.a.createElement(T.a,{color:"inherit"},l.a.createElement(P.a,{badgeContent:11,color:"secondary"},l.a.createElement(Y.a,null))),l.a.createElement("p",null,"Notifications")),l.a.createElement(R.a,{onClick:p},l.a.createElement(T.a,{color:"inherit"},l.a.createElement(A.a,null)),l.a.createElement("p",null,"Profile")));return l.a.createElement("div",{className:e.grow},l.a.createElement(D.a,{position:"static"},l.a.createElement(j.a,null,l.a.createElement(T.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"Open drawer"},l.a.createElement(W.a,null)),l.a.createElement(z.a,{className:e.title,variant:"h6",noWrap:!0},"Material-UI"),l.a.createElement("div",{className:e.search},l.a.createElement("div",{className:e.searchIcon},l.a.createElement(L.a,null)),l.a.createElement(S.a,{placeholder:"Search\u2026",classes:{root:e.inputRoot,input:e.inputInput}})),l.a.createElement("div",{className:e.grow}),l.a.createElement("div",{className:e.sectionDesktop},l.a.createElement(T.a,{color:"inherit"},l.a.createElement(P.a,{badgeContent:4,color:"secondary"},l.a.createElement(G.a,null))),l.a.createElement(T.a,{color:"inherit"},l.a.createElement(P.a,{badgeContent:17,color:"secondary"},l.a.createElement(Y.a,null))),l.a.createElement(T.a,{edge:"end","aria-owns":u?"material-appbar":void 0,"aria-haspopup":"true",onClick:p,color:"inherit"},l.a.createElement(A.a,null))),l.a.createElement("div",{className:e.sectionMobile},l.a.createElement(T.a,{"aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit"},l.a.createElement(q.a,null))))),f,d)};var V=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(Q,null),l.a.createElement("header",{className:"App-header"},l.a.createElement(k,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[259,1,2]]]);
//# sourceMappingURL=main.2a1f6359.chunk.js.map